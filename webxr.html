<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR.js with GLTF Model</title>
    <meta name="viewport" content="width=device-width, user-scalable=yes, minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.0/dist/aframe-extras.loaders.min.js"></script>
</head>
<body style='margin : 0px; overflow: hidden;'>
    <a-scene vr-mode-ui="enabled: false" embedded arjs>
        <!-- Add a camera -->
        <a-entity camera>
            <a-entity id="raycasterCursor" cursor="rayOrigin: mouse; fuse: false" raycaster="objects: .clickable"></a-entity>
        </a-entity>

        <!-- Define the AR marker with 'kanji' preset -->
        <a-marker preset='kanji'>
            <!-- Add the GLTF model -->
            <a-gltf-model src="/public/headset-anim.gltf" position="0 0.2 0" scale="5 5 5" animation-mixer="loop:repeat" class="clickable" onclick="debouncedOnModelClick();"></a-gltf-model>
        </a-marker>

    </a-scene>
    <script>
        function onModelClick()
        {
            alert('Model clicked');
        }

        function debounce(func, wait) {
            let timeout;

            return function executedFunction() {
                const context = this;
                const args = arguments;

                const later = function () {
                    timeout = null;
                    func.apply(context, args);
                };

                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        const debouncedOnModelClick = debounce(onModelClick, 500);

        document.addEventListener('touchstart', enableRaycaster, { passive: true });
        document.addEventListener('mousemove', enableRaycaster, { passive: true });

        function enableRaycaster() {
            const raycasterCursor = document.getElementById('raycasterCursor');
            raycasterCursor.setAttribute('raycaster', 'objects', '.clickable');
        }
    </script>
</body>
</html>